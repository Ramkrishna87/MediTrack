<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‚öïÔ∏è MediTrack ‚Äî Patient Dashboard</title>
  <!-- Inter font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./Patient_Dashboard.css" />
</head>
<body>
  <!-- Welcome overlay -->
  <div id="welcome" class="welcome-overlay" aria-hidden="false">
    <div class="welcome-card">
      <div class="welcome-left">
        <video id="welcome-anim" autoplay loop muted playsinline class="anim-vid">
          <source src="../assets/animations/Doc%20and%20Patient.webm" type="video/webm" />
        </video>
      </div>
      <div class="welcome-right">
        <div class="welcome-emoji">üëã</div>
        <h1 id="welcome-name">Welcome, Patient Name</h1>
        <p class="muted">Signing you in‚Ä¶</p>
      </div>
    </div>
  </div>
  <div class="app-shell">

    <!-- Sidebar (fixed left) -->
    <aside class="sidebar" id="sidebar">
      <div class="brand">
        <div class="logo">‚öïÔ∏è</div>
        <div class="brand-text">
          <h2>MediTrack</h2>
          <small class="muted">Patient Panel</small>
        </div>
      </div>

      <nav class="nav" aria-label="Main navigation">
        <button class="nav-item active" data-view="dashboard">Dashboard</button>
        <button class="nav-item" data-view="appointments">Appointments</button>
        <button class="nav-item" data-view="reports">Reports</button>
        <button class="nav-item" data-view="prescriptions">Prescriptions</button>
        <button class="nav-item" data-view="payments">Payments</button>
        <button class="nav-item" data-view="chat">Chat (QR)</button>
        <button class="nav-item" data-view="settings">Settings</button>
      </nav>

      <div class="sidebar-footer">
        <small class="muted">Signed in as</small>
        <div class="user">Patient Name / User</div>
      </div>
    </aside>

    <!-- Main content -->
    <main class="main-content" id="main-content" tabindex="-1">
      <header class="topbar">
        <div class="title-wrap">
          <h1 class="page-title">Welcome, <span id="display-name">Patient Name</span></h1>
          <p class="subtitle muted">Your health, organized and accessible</p>
        </div>
        <div class="controls">

          <!-- KEEP THE TOGGLE EXACTLY AS YOU HAD IT -->
          <div class="theme-toggle" title="Toggle theme">
            <input type="checkbox" id="toggle" aria-label="Toggle dark mode">
            <label for="toggle" class="toggle-label" role="switch" aria-checked="false">
              <div class="scene">
                <div class="sky">
                  <span class="sun">üåû</span>
                  <span class="moon">üåô</span>
                  <span class="cloud cloud1">‚òÅÔ∏è</span>
                  <span class="cloud cloud2">‚òÅÔ∏è</span>
                  <span class="stars star1">‚ú¶</span>
                  <span class="stars star2">‚ú¶</span>
                  <span class="stars star3">‚ú¶</span>
                  <span class="stars star4">‚ú¶</span>
                </div>
                <div class="land">
                  <span class="tree">üå≥</span>
                </div>
                <div class="fog"></div>
              </div>
              <span class="knob"></span>
            </label>
          </div>
        </div>
      </header>
      <section class="view-container">

        <!-- DASHBOARD VIEW -->
        <section id="view-dashboard" class="view active-view" aria-live="polite">
          <div class="header-row">
            <div class="hero-card">
              <div class="hero-left">
                <h2>Good to see you</h2>
                <p class="muted">Manage appointments, prescriptions, and reports</p>
                <div class="hero-actions">
                  <button class="btn" id="open-appointments">View Appointments</button>
                  <button class="btn ghost" id="open-prescriptions">Prescriptions</button>
                </div>
              </div>
              <div class="hero-right">
                <video class="hero-vid" autoplay loop muted playsinline>
                  <source src="../assets/animations/Doc%20and%20Patient.webm" type="video/webm" />
                </video>
              </div>
            </div>

            <div class="stats-col">
              <div class="stat card hover-tilt">
                <div class="stat-title">üìÖ Upcoming</div>
                <!-- <div class="stat-value" id="stat-upcoming">2 Appointments</div> -->
                 <div id="stat-upcoming">‚Äî</div>
              </div>
              <div class="stat card hover-tilt">
                <div class="stat-title">üíä Prescriptions</div>
                <!-- <div class="stat-value" id="stat-pres">3 Active</div> -->
                 <div id="stat-pres">‚Äî</div>

              </div>
              <div class="stat card hover-tilt">
                <div class="stat-title">üìë Reports</div>
                <!-- <div class="stat-value" id="stat-reports">1 New</div> -->
                 <div id="stat-reports">‚Äî</div>
              </div>
            </div>
          </div>
          <h2 class="section-heading">Available Doctors</h2>

          <div class="doctor-grid" id="dashboard-doctors">
          </div>


          <!-- Right-side drawer -->
          <aside id="right-drawer" class="right-drawer" aria-hidden="true">
            <div class="drawer-header">
              <h3 id="drawer-doctor-name">Doctor</h3>
              <button id="drawer-close" class="icon-btn" aria-label="Close drawer">‚úï</button>
            </div>
            <div class="drawer-body">
              <p class="muted">Specialty: <span id="drawer-specialty">-</span></p>
              <p class="muted">Recent Visit: <span id="drawer-disease">-</span></p>

             <div class="drawer-section">
               <h4>Prescriptions</h4>
               <div class="panel small" id="drawer-pres-list">No prescriptions yet.</div>
              </div>


              <div class="drawer-section">
                <h4>Appointments</h4>
                <div class="panel small" id="drawer-appt-list">No upcoming appointments.</div>
              </div>


              <div class="drawer-section">
                <h4>Actions</h4>
                <div class="panel small">
                  <button id="drawer-prescribe" class="btn small">Open prescription</button>
                  <button id="drawer-book" class="btn small ghost">Book appointment</button>
                  <button id="drawer-whatsapp" class="btn small ghost">Open WhatsApp</button>
                </div>
              </div>
            </div>
          </aside>

          <!-- Info & animations row (Medication Reminder card added) -->
          <div class="info-row">
            <div class="info-left">

              <!-- Medication Reminder Card -->
              <div class="card hover-tilt med-card">
                <div class="med-card-left">
                  <div><strong>Medication Reminders (Today)</strong></div>
                  <div class="muted small">Keep this page open for active alarms</div>
                </div>
                <div class="med-list" id="med-list">

                  <!-- JS will fill dummy items -->
                </div>
                <div class="med-actions">
                  <button class="btn small" id="open-add-reminder">Set Reminder</button>
                </div>
              </div>

              <div class="card hover-tilt appointment-card">
                <div class="left">
                  <div>
                    <strong>Next Appointment</strong>
                    <div class="muted">Dr. Sharma ¬∑ 12 Oct 2025 ¬∑ 11:00 AM</div>
                  </div>
                </div>
                <div class="right anim-slot">
                  <video autoplay loop muted playsinline>
                    <source src="../assets/animations/Appoinments.webm" type="video/webm" />
                  </video>
                </div>
              </div>

              <div class="card hover-tilt prescription-card">
                <div>
                  <strong>Prescription</strong>
                  <div class="muted">Last: 5 days ago</div>
                </div>
                <div class="anim-slot">
                  <video autoplay loop muted playsinline>
                    <source src="../assets/animations/Scanning%20Prescription.webm" type="video/webm" />
                  </video>
                </div>
              </div>
            </div>


            <div class="info-right">
              <div class="card hover-tilt report-card">
                <div>
                  <strong>Reports</strong>
                  <div class="muted">1 new lab result</div>
                </div>
                <div class="anim-slot">
                  <video autoplay loop muted playsinline>
                    <source src="../assets/animations/Female%20Scientist%20Research%20On%20Lab.webm" type="video/webm" />
                  </video>
                </div>
              </div>

              <div class="card hover-tilt payments-card">
                <div>
                  <strong>Payments</strong>
                  <div class="muted">View total expenses & history</div>
                </div>
                <div class="anim-slot">
                  <video autoplay loop muted playsinline>
                    <source src="../assets/animations/Wallet%20Icon.webm" type="video/webm" />
                  </video>
                </div>
              </div>
            </div>
          </div>
        </section>


        <!-- PRESCRIPTIONS VIEW -->
        <section id="view-prescriptions" class="view">
          <div class="prescription-toolbar">
            <button id="pres-back" class="btn-outline">‚Üê Back to Dashboard</button>
          </div>
          <div class="card-list" id="pres-history"></div>
          <hr style="margin:16px 0" />

          <article class="prescription paper" id="prescription">

            <!-- content kept simple; will be populated by JS when needed -->
            <header class="pres-header">
              <img id="pres-qr" class="pres-qr" />
              <div class="hospital">
                <div class="h-name">City Health Clinic</div>
                <div class="h-sub muted">General &amp; Specialized Care</div>
              </div>
              <div class="doc-meta">
                <div class="doc-name">Dr. ‚Äî</div>
                <div class="doc-spec muted">‚Äî</div>
                <div class="pres-meta muted">Date: <span id="pres-date">[Date]</span>  ¬∑  ID: <span id="pres-id">#0001</span></div>
              </div>
            </header>

            <section class="patient-block">
              <div><strong>Patient:</strong> <span id="pres-patient">Patient Name</span></div>
              <div><strong>Age / Sex:</strong> <span id="pres-age">--</span></div>
              <div><strong>Ref.:</strong> <span id="pres-ref">OPD-000</span></div>
            </section>

            <section class="meds-block">
              <table class="med-table">
                <thead>
                  <tr>
                    <th>Medicine</th>
                    <th>Dosage</th>
                    <th>Duration</th>
                    <th>Notes</th>
                  </tr>
                </thead>
                <tbody id="meds-body">
                  <tr>
                    <td><em>Medicine name</em></td>
                    <td>1 tab / day</td>
                    <td>7 days</td>
                    <td>After food</td>
                  </tr>
                </tbody>
              </table>
            </section>

            <section class="advice-block">
              <h4>Advice</h4>
              <p class="muted">Rest, avoid heavy exertion. Return for follow-up after 7 days or earlier if symptoms worsen.</p>
            </section>
          </article>
        </section>

        <!-- APPOINTMENTS VIEW -->
        <section id="view-appointments" class="view">
          <div class="page-header">
            <h2>Find & Book Doctors</h2>
            <p class="muted">Search by name or specialty ‚Äî (mock results). We'll connect Google Places later.</p>
          </div>


          <div class="search-row card">
            <input id="doc-search" type="search" placeholder="Search doctor or specialty (e.g. cardiology, Sharma)" />
            <button id="search-btn" class="btn small">Search</button>
            <div class="search-hint muted">Demo mock search. Connect Google API later.</div>
          </div>

          <div id="search-results" class="doctor-grid" aria-live="polite">

            <!-- JS populates search results -->
          </div>
        </section>

        <!-- REPORTS VIEW -->
        <section id="view-reports" class="view">
          <div class="page-header">
            <h2>Your Reports</h2>
            <p class="muted">Reports shared by your doctors. Click View or Download.</p>
          </div>

          <div id="reports-list" class="card-list">

            <!-- JS will populate mock reports -->
          </div>
        </section>


        <!-- PAYMENTS VIEW -->
        <section id="view-payments" class="view">
          <div class="page-header">
            <h2>Payment History</h2>
            <p class="muted">We store history only. Doctors handle payment collection.</p>
          </div>

          <table class="payments-table card">
            <thead>
              <tr><th>Date</th><th>Purpose</th><th>Amount</th><th>Status</th></tr>
            </thead>
            <tbody id="payments-body"></tbody>
          </table>
        </section>

        <!-- CHAT VIEW (QR-based) -->
        <section id="view-chat" class="view">
          <div class="page-header">
            <h2>Chat with your Doctor (via WhatsApp)</h2>
            <p class="muted">Scan the QR next to a doctor to start a WhatsApp chat. (Client-side QR generation)</p>
          </div>

          <div id="chat-grid" class="card-list">
            <!-- JS will populate QR cards for doctors -->
          </div>
        </section>

                <!-- ================= SETTINGS (NEW) ================= -->

      <section id="view-settings" class="view">
          <h2 class="section-title">Settings</h2>

          <!-- PROFILE -->
          <div class="card settings-card">
            <h3>Profile</h3>
            <label>Full Name</label>
            <input type="text" id="settings-name" placeholder="Enter your full name">

            <label>Email</label>
            <input type="email" id="settings-email" disabled>
            <button class="btn" id="save-profile">Save Changes</button>
          </div>

          <!-- APPEARANCE -->
          <div class="card settings-card">
            <h3>Appearance</h3>
            <label>
              <input type="checkbox" id="settings-dark">
              Enable Dark Mode
            </label>
          </div>


          <!-- NOTIFICATIONS -->
          <div class="card settings-card">
            <h3>Notifications</h3>
            <label><input type="checkbox" checked> Appointment Alerts</label>
            <label><input type="checkbox" checked> Medicine Reminders</label>
            <label><input type="checkbox" checked> Prescription Updates</label>
          </div>

          <!-- SECURITY -->
          <div class="card settings-card">
            <h3>Security</h3>
            <button class="btn danger" id="logout-btn">Logout</button>
          </div>
        </section>
      </section>
    </main>
  </div>

  <!-- Medication Alarm Modal (center, blocking until action) -->
  <div id="med-alarm" class="alarm-modal hidden" aria-hidden="true">
    <div class="alarm-card" role="dialog" aria-modal="true">
      <div class="alarm-left">
        <video id="alarm-anim" autoplay loop muted playsinline>
          <source src="../assets/animations/medicine online.webm" type="video/webm" />
        </video>
      </div>
      <div class="alarm-body">
        <h2 id="alarm-title">Time to take medicine</h2>
        <p id="alarm-sub" class="muted">Paracetamol 500mg ‚Äî 10:00 AM</p>
        
        <div class="alarm-actions">
          <button id="mark-taken" class="btn">Mark as Taken</button>
          <div class="snooze-group">
            <label for="snooze-select" class="muted">Remind me later</label>
            <select id="snooze-select">
              <option value="2">2 minutes</option>
              <option value="5" selected>5 minutes</option>
              <option value="10">10 minutes</option>
              <option value="custom">Custom</option>
            </select>
            <input id="snooze-custom" class="snooze-custom hidden" type="number" min="1" placeholder="mins" />
            <button id="snooze-btn" class="btn ghost">Snooze</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Success modal (reused) -->
  <div id="success-modal" class="modal hidden" role="status" aria-live="polite">
    <div class="modal-card">
      <video autoplay loop muted playsinline class="modal-anim">
        <source src="../assets/animations/Success.webm" type="video/webm" />
      </video>
      <div class="modal-content">
        <h3>Success</h3>
        <p class="muted" id="success-msg">Your action was successful.</p>
        <button class="btn" id="modal-ok">OK</button>
      </div>
    </div>
  </div>

  <!-- Hidden audio: place your alarm here (fallback to hosted if missing) -->
  <audio id="med-sound" src="/assets/sounds/med_alert.mp3" preload="auto"></audio> 

<script src="./Patient_Dashboard.JS" type="module"></script>
</body>
</html>