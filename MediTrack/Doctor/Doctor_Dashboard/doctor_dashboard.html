<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MediTrack ‚Äî Doctor Dashboard</title>

  <link href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://unpkg.com/html5-qrcode@2.3.7/minified/html5-qrcode.min.js"></script>

  <link rel="stylesheet" href="doctor_dashboard.css" />
  <style>
    /* Inline CSS for initial dark mode fix/modal opacity */
    .hidden { display:none; }
    .modal { opacity: 0; }
  </style>
</head>
<body>
  <div class="dashboard-container">
    <aside class="sidebar" id="sidebar">
      <div class="brand">
        <div class="logo">‚öïÔ∏è</div>
        <div class="brand-text">
          <h2>MediTrack</h2>
          <small class="muted">Doctor Panel</small>
        </div>
      </div>

      <nav aria-label="Main navigation">
        <ul id="menuList">
          <li class="nav-item active" data-view="dashboard">üè† Dashboard</li>
          <li class="nav-item" data-view="appointments">üìÖ Appointments</li>
          <li class="nav-item" data-view="patients">üë• Patients</li>
          <li class="nav-item" data-view="prescriptions">üßæ Prescriptions</li>
          <li class="nav-item" data-view="reports">üìä Reports</li>
          <li class="nav-item" data-view="chat">üí¨ Chat</li>
          <hr>
          <li class="nav-item" data-view="documents">üìÇ Documents</li>
          <li class="nav-item" data-view="settings">‚öôÔ∏è Settings</li>
          <li class="nav-item" id="logout-btn">üö™ Sign Out</li>
        </ul>
        <div class="sidebar-indicator" id="sidebarIndicator"></div>
      </nav>

      <div class="sidebar-footer">
        <small class="muted">Signed in as</small>
        <div class="user" id="signedInUser">Dr. Johanna</div>
      </div>
    </aside>

    <main class="main-content" id="main">
      <header class="topbar">
        <div class="title-wrap">
          <h1 id="pageTitle">Dashboard</h1>
          <p class="subtitle muted" id="pageSubtitle">Your clinical summary</p>
        </div>

        <div class="controls">
          <div class="search-wrap">
            <input id="topSearch" type="search" placeholder="Search patients, appointments..." />
          </div>

          <div class="top-tools">
            <div class="dropdown" id="notifRoot" title="Notifications">
              <i class="ri-notification-3-line notif-icon" id="notifIcon"></i>
              <div class="dropdown-menu" id="notifMenu" aria-live="polite"><p class="muted">No new notifications</p></div>
            </div>

            <button id="btnScanQR" class="btn-gold" title="Scan QR">Scan QR</button>
            <button id="btnSettings" class="btn-outline-gold" title="Settings">Settings</button>

            <label class="theme-toggle" title="Toggle theme">
              <input type="checkbox" id="toggleDark" aria-label="Toggle dark mode" />
              <span class="toggle-label" role="switch" aria-checked="false">
                <span class="knob"></span>
              </span>
            </label>
            
            <div class="profile" title="Profile"><i class="ri-user-line"></i></div>
          </div>
        </div>
      </header>

      <section class="view-container">
        <section id="view-dashboard" class="view active-view" aria-live="polite">
          <div class="header-row">
            <div class="hero-card hover-tilt">
              <div class="hero-left">
                <h2 class="welcome-text">Good day, Dr. Johanna</h2>
                <p class="muted" id="welcomeSubtitle">Quick access to patient data, schedule, and performance reports.</p>
                <div class="hero-actions">
                  <button class="btn" id="openAppointments">View Appointments</button>
                  <button class="btn ghost" id="openPrescriptions">Prescriptions</button>
                </div>
              </div>
              <div class="hero-right">
                <video class="hero-vid" autoplay loop muted playsinline>
                  <source src="../../assets/animations/Medical Consultation.webm" type="video/webm" />
                </video>
              </div>
            </div>

            <div class="stats-col">
              <div class="stat card hover-tilt">
                <div class="stat-title">üìÖ Today's</div>
                <div class="stat-value" id="statToday">--</div>
              </div>
              <div class="stat card hover-tilt">
                <div class="stat-title">üíä Prescriptions</div>
                <div class="stat-value" id="statPres">--</div>
              </div>
              <div class="stat card hover-tilt">
                <div class="stat-title">üë• Active Patients</div>
                <div class="stat-value" id="statPatients">--</div>
              </div>
            </div>
          </div>
          
          <div class="reports-and-metrics">
            <div class="card metrics-widget">
                <h3 class="section-heading">Key Patient Status</h3>
                <div class="metric-grid" id="metricsGrid">
                    <div class="metric-item"><strong>Hypertension</strong><span id="metricHTN" class="stat-value small">45</span></div>
                    <div class="metric-item"><strong>Diabetes</strong><span id="metricDM" class="stat-value small">22</span></div>
                    <div class="metric-item"><strong>Migraine</strong><span id="metricMIG" class="stat-value small">15</span></div>
                </div>
            </div>
            
            <div class="card chart-widget">
                <h3 class="section-heading">Appointment Flow</h3>
                <canvas id="appointmentsChartDash"></canvas>
            </div>
          </div>


          <h2 class="section-heading">Upcoming Appointments</h2>
          <div class="card table-container" id="dashboardAppts">
            <table>
              <thead><tr><th>Patient</th><th>Date</th><th>Time</th><th>Status</th><th>Actions</th></tr></thead>
              <tbody id="dashboardApptsBody">
                </tbody>
            </table>
          </div>
        </section>

        <section id="view-appointments" class="view">
          <div class="page-header"><h2>Appointments</h2><p class="muted">Manage your schedule</p></div>
          <div class="card table-container">
            <div class="table-actions">
              <button class="btn" id="btnAddAppt">+ New Appointment</button>
              <input id="filterAppt" placeholder="Filter by patient" />
            </div>
            <table>
              <thead><tr><th>Patient</th><th>Date</th><th>Time</th><th>Status</th><th>Actions</th></tr></thead>
              <tbody id="apptBody"></tbody>
            </table>
          </div>
        </section>

        <section id="view-patients" class="view">
          <div class="page-header"><h2>Patients</h2><p class="muted">Patient records & quick actions</p></div>
          <div class="card table-container">
            <div class="table-actions">
              <button class="btn" id="btnAddPatient">+ Add Patient</button>
              <input id="filterPatient" placeholder="Search patient" />
            </div>
            <div id="patientsList" class="card-list"></div>
          </div>
        </section>

        <section id="view-prescriptions" class="view">
          <div class="page-header"><h2>Prescriptions</h2><p class="muted">Create and manage prescriptions. Scan QR or click 'Open' to view details.</p></div>
          <div class="card table-container">
            <div class="table-actions">
              <button class="btn" id="btnNewPrescription">+ New Prescription</button>
              <input id="filterPres" placeholder="Filter by patient or medicine" />
            </div>
            <div id="presList" class="card-list"></div>
          </div>
        </section>

        <section id="view-reports" class="view">
          <div class="page-header"><h2>Reports & Analytics</h2><p class="muted">Deep dive into clinical load and key patient demographics.</p></div>
          <div class="report-grid">
            <div class="report-card card"><h3>Patient Demographics</h3><canvas id="patientsChart"></canvas></div>
            <div class="report-card card"><h3>Appointment Status Breakdown</h3><canvas id="appointmentsChart"></canvas></div>
          </div>
        </section>

        <section id="view-chat" class="view">
          <div class="page-header"><h2>Chat (WhatsApp)</h2><p class="muted">Open patient chat via WhatsApp</p></div>
          <div class="card-list" id="chatList"></div>
        </section>

        <section id="view-documents" class="view">
        <div class="page-header">
        <h2>Documents</h2>
        <p class="muted">Upload and manage reports</p>
     </div>

    <div class="card">
     <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
      <strong>Uploaded Documents</strong>

      <button id="uploadDocBtn" class="btn small">
        Upload Document
      </button>

      <input
        type="file"
        id="docFileInput"
        accept=".pdf,.jpg,.jpeg,.png,.txt"
        style="display:none"
      />
    </div>

    <div id="docsList" class="card-list">
      <div class="muted">No documents uploaded</div>
    </div>
  </div>
</section>

        <section id="view-settings" class="view">
          <div class="page-header"><h2>Settings</h2><p class="muted">App preferences and security</p></div>
          <div class="settings-grid">
            <div class="card">
              <h4>Theme & Display</h4>
              <p class="muted">Toggle app theme</p>
              <div style="margin-top:10px;display:flex;flex-direction:column;gap:8px;">
                <label><input type="checkbox" id="settingDark"/> Enable Dark Mode</label>
                <hr style="opacity:0.2"/>
                <label>Default View:</label>
                <select style="padding:6px;border-radius:6px;">
                    <option>Dashboard</option>
                    <option>Appointments</option>
                </select>
              </div>
            </div>

            <div class="card">
              <h4>Notifications</h4>
              <p class="muted">Control alert preferences</p>
              <div style="margin-top:10px;display:flex;flex-direction:column;gap:8px">
                <label><input type="checkbox" id="settingNotifApp" checked/> New Appointment alerts</label>
                <label><input type="checkbox" id="settingNotifPharm" checked/> Pharmacy substitution requests</label>
                <label><input type="checkbox" id="settingSound" checked/> Play sound for alarms</label>
              </div>
            </div>

            <div class="card">
              <h4>Account & Security</h4>
              <p class="muted">Authentication & account actions</p>
              <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
                <button id="btnSignOut" class="btn ghost">Sign out</button>
                <button id="btnResetPass" class="btn ghost">Reset password</button>
                <button id="btnExportData" class="btn ghost small">Export Data</button>
              </div>
            </div>

            <div class="card">
              <h4>API/Integrations</h4>
              <p class="muted">Manage external access keys</p>
              <div style="margin-top:10px;">
                <label>Pharmacy API Key:</label>
                <input type="text" placeholder="*************" style="width:100%;padding:6px;margin-top:4px;border-radius:6px;border:1px solid rgba(0,0,0,0.08)"/>
                <button class="btn small" style="margin-top:8px;">Generate New Key</button>
              </div>
            </div>
          </div>
        </section>

      </section>
    </main>
  </div>

  <div id="modalsRoot"></div>
  
  <div id="editApptModal" class="modal hidden">
    <div class="card" style="width:min(400px, 96%)">
        <h3>Edit Appointment</h3>
        <p class="muted" id="editApptPatientName">Patient: --</p>
        <div style="margin-top:12px;">
            <label class="muted">Date</label>
            <input type="date" id="editApptDate" style="width:100%;padding:10px;margin-top:4px;border-radius:8px;border:1px solid rgba(0,0,0,0.08)"/>
        </div>
        <div style="margin-top:12px;">
            <label class="muted">Time</label>
            <input type="time" id="editApptTime" style="width:100%;padding:10px;margin-top:4px;border-radius:8px;border:1px solid rgba(0,0,0,0.08)"/>
        </div>
        <div style="margin-top:12px;">
            <label class="muted">Status</label>
            <select id="editApptStatus" style="width:100%;padding:10px;margin-top:4px;border-radius:8px;border:1px solid rgba(0,0,0,0.08)">
                <option value="pending">Pending</option>
                <option value="confirmed">Confirmed</option>
                <option value="completed">Completed</option>
                <option value="cancelled">Cancelled</option>
            </select>
        </div>
        <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:20px">
            <button id="saveEditAppt" class="btn">Save Changes</button>
            <button id="cancelEditAppt" class="btn small ghost">Cancel</button>
        </div>
    </div>
  </div>

  <script type="module" src="doctor_dashboard.js" defer></script>
</body>
</html>